{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/firebase.ts"],"sourcesContent":["// src/lib/firebase.ts\nimport { initializeApp, getApps, getApp } from 'firebase/app';\nimport { getFirestore } from 'firebase/firestore';\nimport { getAuth } from \"firebase/auth\"; // Added for Firebase Auth\n\n// Load environment variables from .env.local at the project root\n// This is automatically handled by Next.js in the app runtime.\n// Scripts like load-properties.ts need to load .env.local explicitly.\n\nconst firebaseConfig = {\n  apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,\n  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,\n  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\n  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,\n  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,\n  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,\n};\n\n// Initialize Firebase Client SDK\nlet app;\nif (getApps().length === 0) {\n  if (!firebaseConfig.apiKey || !firebaseConfig.projectId) {\n    console.error(\n      \"❌ Client Firebase Config Missing: NEXT_PUBLIC_FIREBASE_API_KEY or NEXT_PUBLIC_FIREBASE_PROJECT_ID is missing. Client SDK cannot initialize.\"\n    );\n    // Potentially throw an error or handle this case as critical\n  } else {\n    try {\n      app = initializeApp(firebaseConfig);\n      // console.log(\"✅ Firebase Client SDK initialized successfully.\");\n    } catch (initError) {\n      console.error(\"❌ Firebase Client SDK initialization failed:\", initError);\n    }\n  }\n} else {\n  app = getApp();\n  // console.log(\"ℹ️ Firebase Client SDK app already initialized.\");\n}\n\nlet db;\nlet auth; // Declare auth\n\nif (app) {\n  try {\n    db = getFirestore(app);\n    auth = getAuth(app); // Initialize auth\n    // console.log(\"✅ Firestore and Auth Client SDKs initialized successfully.\");\n  } catch (sdkError) {\n    console.error(\"❌ Firestore or Auth Client SDK initialization failed:\", sdkError);\n  }\n} else {\n  console.error(\"❌ Cannot initialize Firestore/Auth Client SDKs because Firebase app is not available.\");\n}\n\nexport { app, db, auth }; // Export auth\n"],"names":[],"mappings":"AAAA,sBAAsB;;;;;;AAUZ;AATV;AAAA;AACA;AAAA;AACA,0UAAyC,0BAA0B;AAAnE;;;;AAEA,iEAAiE;AACjE,+DAA+D;AAC/D,sEAAsE;AAEtE,MAAM,iBAAiB;IACrB,MAAM;IACN,UAAU;IACV,SAAS;IACT,aAAa;IACb,iBAAiB;IACjB,KAAK;AACP;AAEA,iCAAiC;AACjC,IAAI;AACJ,IAAI,CAAA,GAAA,uLAAA,CAAA,UAAO,AAAD,IAAI,MAAM,KAAK,GAAG;IAC1B,IAAI,CAAC,eAAe,MAAM,IAAI,CAAC,eAAe,SAAS,EAAE;QACvD,QAAQ,KAAK,CACX;IAEF,6DAA6D;IAC/D,OAAO;QACL,IAAI;YACF,MAAM,CAAA,GAAA,uLAAA,CAAA,gBAAa,AAAD,EAAE;QACpB,kEAAkE;QACpE,EAAE,OAAO,WAAW;YAClB,QAAQ,KAAK,CAAC,gDAAgD;QAChE;IACF;AACF,OAAO;IACL,MAAM,CAAA,GAAA,uLAAA,CAAA,SAAM,AAAD;AACX,kEAAkE;AACpE;AAEA,IAAI;AACJ,IAAI,MAAM,eAAe;AAEzB,IAAI,KAAK;IACP,IAAI;QACF,KAAK,CAAA,GAAA,sKAAA,CAAA,eAAY,AAAD,EAAE;QAClB,OAAO,CAAA,GAAA,yOAAA,CAAA,UAAO,AAAD,EAAE,MAAM,kBAAkB;IACvC,6EAA6E;IAC/E,EAAE,OAAO,UAAU;QACjB,QAAQ,KAAK,CAAC,yDAAyD;IACzE;AACF,OAAO;IACL,QAAQ,KAAK,CAAC;AAChB;;;;;CAE0B,cAAc","debugId":null}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/contexts/AuthContext.tsx"],"sourcesContent":["// src/contexts/AuthContext.tsx\n'use client';\n\nimport type { ReactNode, Dispatch, SetStateAction } from 'react';\nimport { createContext, useContext, useEffect, useState } from 'react';\nimport {\n  onAuthStateChanged,\n  signInWithPopup,\n  GoogleAuthProvider,\n  signOut as firebaseSignOut, // Renamed to avoid conflict\n  type User as FirebaseUser,\n} from 'firebase/auth';\nimport { auth } from '@/lib/firebase'; // Assuming auth is exported from your firebase setup\nimport { useRouter } from 'next/navigation';\nimport { Loader2 } from 'lucide-react';\n\ninterface AuthContextType {\n  user: FirebaseUser | null;\n  loading: boolean;\n  signInWithGoogle: () => Promise<void>;\n  logout: () => Promise<void>;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport const AuthProvider = ({ children }: { children: ReactNode }) => {\n  const [user, setUser] = useState<FirebaseUser | null>(null);\n  const [loading, setLoading] = useState(true);\n  const router = useRouter();\n\n  useEffect(() => {\n    if (!auth) {\n      console.error(\"[AuthProvider] Firebase Auth is not initialized.\");\n      setLoading(false);\n      return;\n    }\n    const unsubscribe = onAuthStateChanged(auth, (currentUser) => {\n      setUser(currentUser);\n      setLoading(false);\n    });\n    return () => unsubscribe();\n  }, []);\n\n  const signInWithGoogle = async () => {\n    if (!auth) {\n        console.error(\"[AuthProvider] Firebase Auth is not initialized for signInWithGoogle.\");\n        return;\n    }\n    setLoading(true);\n    try {\n      const provider = new GoogleAuthProvider();\n      await signInWithPopup(auth, provider);\n      // onAuthStateChanged will handle setting the user and redirecting\n    } catch (error) {\n      console.error('Error signing in with Google:', error);\n      setLoading(false);\n    }\n  };\n\n  const logout = async () => {\n    if (!auth) {\n        console.error(\"[AuthProvider] Firebase Auth is not initialized for logout.\");\n        return;\n    }\n    setLoading(true);\n    try {\n      await firebaseSignOut(auth);\n      setUser(null);\n      router.push('/login'); // Redirect to login page after logout\n    } catch (error) {\n      console.error('Error signing out:', error);\n    } finally {\n        setLoading(false);\n    }\n  };\n\n  if (loading && !auth) { // Special case if auth itself failed to init\n    return (\n      <div className=\"flex min-h-screen items-center justify-center\">\n        <p className=\"text-red-500\">Error: Firebase Authentication failed to initialize.</p>\n      </div>\n    );\n  }\n  \n\n  return (\n    <AuthContext.Provider value={{ user, loading, signInWithGoogle, logout }}>\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\nexport const useAuth = (): AuthContextType => {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};\n"],"names":[],"mappings":"AAAA,+BAA+B;;;;;;AAI/B;AACA;AAAA;AAAA;AAAA;AAAA;AAOA,oNAAuC,qDAAqD;AAC5F;;;AAZA;;;;;AAsBA,MAAM,4BAAc,CAAA,GAAA,6JAAA,CAAA,gBAAa,AAAD,EAA+B;AAExD,MAAM,eAAe,CAAC,EAAE,QAAQ,EAA2B;;IAChE,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAuB;IACtD,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IAEvB,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;kCAAE;YACR,IAAI,CAAC,yHAAA,CAAA,OAAI,EAAE;gBACT,QAAQ,KAAK,CAAC;gBACd,WAAW;gBACX;YACF;YACA,MAAM,cAAc,CAAA,GAAA,oPAAA,CAAA,qBAAkB,AAAD,EAAE,yHAAA,CAAA,OAAI;sDAAE,CAAC;oBAC5C,QAAQ;oBACR,WAAW;gBACb;;YACA;0CAAO,IAAM;;QACf;iCAAG,EAAE;IAEL,MAAM,mBAAmB;QACvB,IAAI,CAAC,yHAAA,CAAA,OAAI,EAAE;YACP,QAAQ,KAAK,CAAC;YACd;QACJ;QACA,WAAW;QACX,IAAI;YACF,MAAM,WAAW,IAAI,oPAAA,CAAA,qBAAkB;YACvC,MAAM,CAAA,GAAA,iPAAA,CAAA,kBAAe,AAAD,EAAE,yHAAA,CAAA,OAAI,EAAE;QAC5B,kEAAkE;QACpE,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,iCAAiC;YAC/C,WAAW;QACb;IACF;IAEA,MAAM,SAAS;QACb,IAAI,CAAC,yHAAA,CAAA,OAAI,EAAE;YACP,QAAQ,KAAK,CAAC;YACd;QACJ;QACA,WAAW;QACX,IAAI;YACF,MAAM,CAAA,GAAA,yOAAA,CAAA,UAAe,AAAD,EAAE,yHAAA,CAAA,OAAI;YAC1B,QAAQ;YACR,OAAO,IAAI,CAAC,WAAW,sCAAsC;QAC/D,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,sBAAsB;QACtC,SAAU;YACN,WAAW;QACf;IACF;IAEA,IAAI,WAAW,CAAC,yHAAA,CAAA,OAAI,EAAE;QACpB,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAE,WAAU;0BAAe;;;;;;;;;;;IAGlC;IAGA,qBACE,6LAAC,YAAY,QAAQ;QAAC,OAAO;YAAE;YAAM;YAAS;YAAkB;QAAO;kBACpE;;;;;;AAGP;GAjEa;;QAGI,qIAAA,CAAA,YAAS;;;KAHb;AAmEN,MAAM,UAAU;;IACrB,MAAM,UAAU,CAAA,GAAA,6JAAA,CAAA,aAAU,AAAD,EAAE;IAC3B,IAAI,YAAY,WAAW;QACzB,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;IANa","debugId":null}}]
}