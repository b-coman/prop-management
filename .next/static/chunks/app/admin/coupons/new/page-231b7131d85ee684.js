(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[907],{285:(e,t,a)=>{"use strict";a.d(t,{$:()=>d,r:()=>l});var r=a(5155),n=a(2115),s=a(9708),o=a(2085),i=a(9434);let l=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=n.forwardRef((e,t)=>{let{className:a,variant:n,size:o,asChild:d=!1,...c}=e,u=d?s.DX:"button";return(0,r.jsx)(u,{className:(0,i.cn)(l({variant:n,size:o,className:a})),ref:t,...c})});d.displayName="Button"},333:(e,t,a)=>{"use strict";a.d(t,{d:()=>i});var r=a(5155),n=a(2115),s=a(239),o=a(9434);let i=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(s.bL,{className:(0,o.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...n,ref:t,children:(0,r.jsx)(s.zi,{className:(0,o.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});i.displayName=s.bL.displayName},2346:(e,t,a)=>{"use strict";a.r(t),a.d(t,{Separator:()=>i});var r=a(5155),n=a(2115),s=a(7489),o=a(9434);let i=n.forwardRef((e,t)=>{let{className:a,orientation:n="horizontal",decorative:i=!0,...l}=e;return(0,r.jsx)(s.b,{ref:t,decorative:i,orientation:n,className:(0,o.cn)("shrink-0 bg-border","horizontal"===n?"h-[1px] w-full":"h-full w-[1px]",a),...l})});i.displayName=s.b.displayName},2523:(e,t,a)=>{"use strict";a.d(t,{p:()=>o});var r=a(5155),n=a(2115),s=a(9434);let o=n.forwardRef((e,t)=>{let{className:a,type:n,...o}=e;return(0,r.jsx)("input",{type:n,className:(0,s.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...o})});o.displayName="Input"},2774:(e,t,a)=>{"use strict";a.d(t,{CouponForm:()=>I});var r=a(5155),n=a(221),s=a(2177),o=a(5594),i=a(3013),l=a(1920),d=a(7223),c=a(8046),u=a(172),m=a(2115),x=a(285),f=a(9708),p=a(9434),h=a(5057);let g=s.Op,b=m.createContext({}),v=e=>{let{...t}=e;return(0,r.jsx)(b.Provider,{value:{name:t.name},children:(0,r.jsx)(s.xI,{...t})})},j=()=>{let e=m.useContext(b),t=m.useContext(y),{getFieldState:a,formState:r}=(0,s.xW)(),n=a(e.name,r);if(!e)throw Error("useFormField should be used within <FormField>");let{id:o}=t;return{id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message"),...n}},y=m.createContext({}),w=m.forwardRef((e,t)=>{let{className:a,...n}=e,s=m.useId();return(0,r.jsx)(y.Provider,{value:{id:s},children:(0,r.jsx)("div",{ref:t,className:(0,p.cn)("space-y-2",a),...n})})});w.displayName="FormItem";let N=m.forwardRef((e,t)=>{let{className:a,...n}=e,{error:s,formItemId:o}=j();return(0,r.jsx)(h.J,{ref:t,className:(0,p.cn)(s&&"text-destructive",a),htmlFor:o,...n})});N.displayName="FormLabel";let k=m.forwardRef((e,t)=>{let{...a}=e,{error:n,formItemId:s,formDescriptionId:o,formMessageId:i}=j();return(0,r.jsx)(f.DX,{ref:t,id:s,"aria-describedby":n?"".concat(o," ").concat(i):"".concat(o),"aria-invalid":!!n,...a})});k.displayName="FormControl";let C=m.forwardRef((e,t)=>{let{className:a,...n}=e,{formDescriptionId:s}=j();return(0,r.jsx)("p",{ref:t,id:s,className:(0,p.cn)("text-sm text-muted-foreground",a),...n})});C.displayName="FormDescription";let S=m.forwardRef((e,t)=>{var a;let{className:n,children:s,...o}=e,{error:i,formMessageId:l}=j(),d=i?String(null!==(a=null==i?void 0:i.message)&&void 0!==a?a:""):s;return d?(0,r.jsx)("p",{ref:t,id:l,className:(0,p.cn)("text-sm font-medium text-destructive",n),...o,children:d}):null});S.displayName="FormMessage";var _=a(2523),A=a(5511),D=a(4636),P=a(333),U=a(7481),E=a(4477);let V=(0,E.createServerReference)("40cbe5635daef9b72f467629e23a1394f3a7d85fd6",E.callServer,void 0,E.findSourceMapURL,"createCouponAction");var F=a(2346);let z=o.z.object({start:o.z.date(),end:o.z.date()}).refine(e=>e.end>e.start,{message:"Exclusion end date must be after start date.",path:["end"]}),T=o.z.object({code:o.z.string().min(3,{message:"Coupon code must be at least 3 characters."}).max(50,{message:"Coupon code cannot exceed 50 characters."}).transform(e=>e.toUpperCase()),discount:o.z.coerce.number().min(1,{message:"Discount percentage must be at least 1."}).max(100,{message:"Discount percentage cannot exceed 100."}),validUntil:o.z.date({required_error:"Coupon expiry date is required."}),isActive:o.z.boolean().default(!0),description:o.z.string().max(100,{message:"Description cannot exceed 100 characters."}).optional(),bookingValidFrom:o.z.date().nullable().optional(),bookingValidUntil:o.z.date().nullable().optional(),exclusionPeriods:o.z.array(z).optional()}).refine(e=>!e.bookingValidFrom||!e.bookingValidUntil||e.bookingValidUntil>e.bookingValidFrom,{message:"Booking validity end date must be after start date.",path:["bookingValidUntil"]}).refine(e=>!e.validUntil||!e.bookingValidUntil||e.validUntil>=e.bookingValidUntil,{message:"Coupon expiry date must be on or after the booking validity end date.",path:["validUntil"]});function I(){let[e,t]=(0,m.useState)(!1),{toast:a}=(0,U.dj)(),o=(0,s.mN)({resolver:(0,n.u)(T),defaultValues:{code:"",discount:10,validUntil:new Date(new Date().setMonth(new Date().getMonth()+1)),isActive:!0,description:"",bookingValidFrom:null,bookingValidUntil:null,exclusionPeriods:[]}}),{fields:f,append:h,remove:b}=(0,s.jz)({control:o.control,name:"exclusionPeriods"});async function j(e){t(!0),console.log("Submitting coupon data:",e);try{var r;let t={...e,validUntil:e.validUntil,bookingValidFrom:e.bookingValidFrom,bookingValidUntil:e.bookingValidUntil,exclusionPeriods:null===(r=e.exclusionPeriods)||void 0===r?void 0:r.map(e=>({start:e.start,end:e.end}))},n=await V(t);n.error?a({title:"Error Creating Coupon",description:n.error,variant:"destructive"}):(a({title:"Coupon Created",description:'Coupon "'.concat(n.code,'" created successfully with ID: ').concat(n.id)}),o.reset())}catch(e){console.error("Error in onSubmit:",e),a({title:"An Unexpected Error Occurred",description:"Please try again later.",variant:"destructive"})}finally{t(!1)}}let y=e=>{let{name:t,label:a,description:n}=e;return(0,r.jsx)(v,{control:o.control,name:t,render:e=>{var s;let{field:o}=e;return(0,r.jsxs)(w,{className:"flex flex-col",children:[(0,r.jsx)(N,{children:a}),(0,r.jsxs)(D.AM,{children:[(0,r.jsx)(D.Wv,{asChild:!0,children:(0,r.jsx)(k,{children:(0,r.jsxs)(x.$,{variant:"outline",className:(0,p.cn)("w-[240px] pl-3 text-left font-normal",!o.value&&"text-muted-foreground"),children:[o.value?(0,i.GP)(o.value,"PPP"):(0,r.jsx)("span",{children:"Pick a date"}),(0,r.jsx)(l.A,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),(0,r.jsx)(D.hl,{className:"w-auto p-0",align:"start",children:(0,r.jsx)(A.V,{mode:"single",selected:null!==(s=o.value)&&void 0!==s?s:void 0,onSelect:e=>o.onChange(null!=e?e:null),disabled:e=>"validUntil"===t&&e<new Date(new Date().setHours(0,0,0,0)),initialFocus:!0})})]}),(0,r.jsx)(C,{children:n}),(0,r.jsx)(S,{})]})}})};return(0,r.jsx)(g,{...o,children:(0,r.jsxs)("form",{onSubmit:o.handleSubmit(j),className:"space-y-8",children:[(0,r.jsx)(v,{control:o.control,name:"code",render:e=>{let{field:t}=e;return(0,r.jsxs)(w,{children:[(0,r.jsx)(N,{children:"Coupon Code"}),(0,r.jsx)(k,{children:(0,r.jsx)(_.p,{placeholder:"e.g., SUMMER25",...t})}),(0,r.jsx)(C,{children:"Unique code (will be uppercase)."}),(0,r.jsx)(S,{})]})}}),(0,r.jsx)(v,{control:o.control,name:"discount",render:e=>{let{field:t}=e;return(0,r.jsxs)(w,{children:[(0,r.jsx)(N,{children:"Discount (%)"}),(0,r.jsx)(k,{children:(0,r.jsx)(_.p,{type:"number",min:"1",max:"100",placeholder:"e.g., 15",...t})}),(0,r.jsx)(C,{children:"Percentage discount (1-100)."}),(0,r.jsx)(S,{})]})}}),(0,r.jsx)(y,{name:"validUntil",label:"Coupon Expiry Date",description:"The last day the coupon code itself can be applied."}),(0,r.jsx)(v,{control:o.control,name:"isActive",render:e=>{let{field:t}=e;return(0,r.jsxs)(w,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[(0,r.jsxs)("div",{className:"space-y-0.5",children:[(0,r.jsx)(N,{className:"text-base",children:"Active"}),(0,r.jsx)(C,{children:"Enable this coupon."})]}),(0,r.jsx)(k,{children:(0,r.jsx)(P.d,{checked:t.value,onCheckedChange:t.onChange})})]})}}),(0,r.jsx)(v,{control:o.control,name:"description",render:e=>{let{field:t}=e;return(0,r.jsxs)(w,{children:[(0,r.jsx)(N,{children:"Description (Optional)"}),(0,r.jsx)(k,{children:(0,r.jsx)(_.p,{placeholder:"e.g., Special summer promotion",...t})}),(0,r.jsx)(C,{children:"Internal note."}),(0,r.jsx)(S,{})]})}}),(0,r.jsx)(F.Separator,{}),(0,r.jsx)("h3",{className:"text-lg font-medium",children:"Booking Validity Period (Optional)"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Define the check-in/check-out date range for which this coupon is valid. Leave blank if valid anytime."}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)(y,{name:"bookingValidFrom",label:"Valid for Bookings FROM",description:"Check-in date must be on or after this date."}),(0,r.jsx)(y,{name:"bookingValidUntil",label:"Valid for Bookings UNTIL",description:"Check-out date must be on or before this date."})]}),(0,r.jsx)(F.Separator,{}),(0,r.jsx)("h3",{className:"text-lg font-medium",children:"Exclusion Periods (Optional)"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Define date ranges where this coupon CANNOT be applied, even if within the validity period."}),(0,r.jsx)("div",{className:"space-y-4",children:f.map((e,t)=>(0,r.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-end gap-4 border p-4 rounded-md relative",children:[(0,r.jsx)(v,{control:o.control,name:"exclusionPeriods.".concat(t,".start"),render:e=>{let{field:t}=e;return(0,r.jsxs)(w,{className:"flex flex-col flex-grow",children:[(0,r.jsx)(N,{children:"Exclusion Start Date"}),(0,r.jsxs)(D.AM,{children:[(0,r.jsx)(D.Wv,{asChild:!0,children:(0,r.jsx)(k,{children:(0,r.jsxs)(x.$,{variant:"outline",className:(0,p.cn)("w-full md:w-[200px] pl-3 text-left font-normal",!t.value&&"text-muted-foreground"),children:[t.value?(0,i.GP)(t.value,"PPP"):(0,r.jsx)("span",{children:"Pick start date"}),(0,r.jsx)(l.A,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),(0,r.jsx)(D.hl,{className:"w-auto p-0",align:"start",children:(0,r.jsx)(A.V,{mode:"single",selected:t.value,onSelect:t.onChange,initialFocus:!0})})]}),(0,r.jsx)(S,{})]})}}),(0,r.jsx)(v,{control:o.control,name:"exclusionPeriods.".concat(t,".end"),render:e=>{let{field:t}=e;return(0,r.jsxs)(w,{className:"flex flex-col flex-grow",children:[(0,r.jsx)(N,{children:"Exclusion End Date"}),(0,r.jsxs)(D.AM,{children:[(0,r.jsx)(D.Wv,{asChild:!0,children:(0,r.jsx)(k,{children:(0,r.jsxs)(x.$,{variant:"outline",className:(0,p.cn)("w-full md:w-[200px] pl-3 text-left font-normal",!t.value&&"text-muted-foreground"),children:[t.value?(0,i.GP)(t.value,"PPP"):(0,r.jsx)("span",{children:"Pick end date"}),(0,r.jsx)(l.A,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),(0,r.jsx)(D.hl,{className:"w-auto p-0",align:"start",children:(0,r.jsx)(A.V,{mode:"single",selected:t.value,onSelect:t.onChange,initialFocus:!0})})]}),(0,r.jsx)(S,{})]})}}),(0,r.jsxs)(x.$,{type:"button",variant:"destructive",size:"icon",onClick:()=>b(t),className:"mt-4 md:mt-0",children:[(0,r.jsx)(d.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Remove exclusion period"})]})]},e.id))}),(0,r.jsxs)(x.$,{type:"button",variant:"outline",size:"sm",className:"mt-4",onClick:()=>h({start:new Date,end:new Date(new Date().setDate(new Date().getDate()+1))}),children:[(0,r.jsx)(c.A,{className:"mr-2 h-4 w-4"})," Add Exclusion Period"]}),(0,r.jsx)(F.Separator,{}),(0,r.jsx)(x.$,{type:"submit",disabled:e,children:e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):"Create Coupon"})]})})}},4636:(e,t,a)=>{"use strict";a.d(t,{AM:()=>i,Wv:()=>l,hl:()=>d});var r=a(5155),n=a(2115),s=a(5178),o=a(9434);let i=s.bL,l=s.l9,d=n.forwardRef((e,t)=>{let{className:a,align:n="center",sideOffset:i=4,...l}=e;return(0,r.jsx)(s.ZL,{children:(0,r.jsx)(s.UC,{ref:t,align:n,sideOffset:i,className:(0,o.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...l})})});d.displayName=s.UC.displayName},5057:(e,t,a)=>{"use strict";a.d(t,{J:()=>d});var r=a(5155),n=a(2115),s=a(968),o=a(2085),i=a(9434);let l=(0,o.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(s.b,{ref:t,className:(0,i.cn)(l(),a),...n})});d.displayName=s.b.displayName},5511:(e,t,a)=>{"use strict";a.d(t,{V:()=>d});var r=a(5155);a(2115);var n=a(965),s=a(3158),o=a(3900),i=a(9434),l=a(285);function d(e){let{className:t,classNames:a,showOutsideDays:d=!0,...c}=e;return(0,r.jsx)(o.hv,{showOutsideDays:d,className:(0,i.cn)("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,i.cn)((0,l.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,i.cn)((0,l.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},components:{IconLeft:e=>{let{className:t,...a}=e;return(0,r.jsx)(n.A,{className:(0,i.cn)("h-4 w-4",t),...a})},IconRight:e=>{let{className:t,...a}=e;return(0,r.jsx)(s.A,{className:(0,i.cn)("h-4 w-4",t),...a})}},...c})}d.displayName="Calendar"},7481:(e,t,a)=>{"use strict";a.d(t,{dj:()=>m});var r=a(2115);let n=0,s=new Map,o=e=>{if(s.has(e))return;let t=setTimeout(()=>{s.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?o(a):e.toasts.forEach(e=>{o(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],d={toasts:[]};function c(e){d=i(d,e),l.forEach(e=>{e(d)})}function u(e){let{...t}=e,a=(n=(n+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:a});return c({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||r()}}}),{id:a,dismiss:r,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function m(){let[e,t]=r.useState(d);return r.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},9082:(e,t,a)=>{Promise.resolve().then(a.bind(a,2774))},9434:(e,t,a)=>{"use strict";a.d(t,{cn:()=>s});var r=a(2596),n=a(9688);function s(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.QP)((0,r.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[198,756,885,181,441,684,358],()=>t(9082)),_N_E=e.O()}]);